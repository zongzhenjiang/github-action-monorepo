on: push

jobs:
    loop-through-projects:
        runs-on: ubuntu-latest
        steps:
        - name: Checkout Code
          uses: actions/checkout@v2
  
        - name: Loop
          run: |
            # 进入目标文件夹
            for dir in webs/*; do
              if [ -d "$dir" ]; then
                echo "Processing directory: $dir"
                if [ -f "$dir/package.json" ]; then
                    new_version=$(jq -r '.version' "$dir/package.json")
                    old_version=$(git show HEAD^:"$dir/package.json" | jq -r '.version')
                    echo "New package version: $new_version"
                    echo "Old package version: $old_version"
                fi
              fi
            done